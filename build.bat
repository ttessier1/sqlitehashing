@echo off

REM this batch assumes a project path where sqlite is installed in a folder "sqlite" one folder up 
REM thie batch assumes a project path where cryptopp is installed in a folder "cryptopp" on folderup
REM make adjustments as necessary to find appropriate folders

set SQLITE_DIR=..\sqlite
set SQLITE=%SQLITE_DIR%\sqlite3.exe
set SQLITE_INC=%SQLITE_DIR%
set SQLITE_LIB=%SQLITE_DIR%
set CRYPTOPP_DIR=..\cryptopp\
set CRYPTOPP_INC=%CRYPTOPP_DIR%
set CRYPTOPP_LIB=%CRYPTOPP_DIR%x64\Output\Release
set TEST_FUNCTIONS=test_functions.txt

set SQLITE_LIB_FILE=sqlite3.lib
set CRYPTOPP_LIB_FILE=cryptlib.lib

set HASHING_C=hashing.c
set CRYPTO_HASHING_CPP=crypto_hashing.cpp
set CRYPTO_HASHING_BLOB_CPP=crypto_blob.cpp
set CRYPTO_MAC_CPP=crypto_mac.cpp
set CRYPTO_MAC_BLOB_CPP=crypto_mac_blob.cpp
set CONTEXT_CPP=blobContext.cpp

REM uncomment below to enable 
set CRYPTOPP=/D__CRYPTOCPP__
set ENABLED_USE_BLOB=/D__USE_BLOB__
set ENABLED_USE_MAC=/D__USE_MAC__
set ENABLED_MD2=/D__MD2__
set ENABLED_MD4=/D__MD4__
set ENABLED_MD5=/D__MD5__
set ENABLED_SHA1=/D__SHA1__
set ENABLED_SHA224=/D__SHA224__
set ENABLED_SHA256=/D__SHA256__
set ENABLED_SHA384=/D__SHA384__
set ENABLED_SHA512=/D__SHA512__
set ENABLED_SHA3224=/D__SHA3224__
set ENABLED_SHA3256=/D__SHA3256__
set ENABLED_SHA3384=/D__SHA3384__
set ENABLED_SHA3512=/D__SHA3512__

set ENABLED_RIPEMD128=/D__RIPEMD128__
set ENABLED_RIPEMD160=/D__RIPEMD160__
set ENABLED_RIPEMD256=/D__RIPEMD256__
set ENABLED_RIPEMD320=/D__RIPEMD320__

set ENABLED_BLAKE2B=/D__BLAKE2B__
set ENABLED_BLAKE2S=/D__BLAKE2S__

set ENABLED_TIGER=/D__TIGER__


set ENABLED_SHAKE128=/D__SHAKE128__
set ENABLED_SHAKE256=/D__SHAKE256__

set ENABLED_SIPHASH64=/D__SIPHASH64__
set ENABLED_SIPHASH128=/D__SIPHASH128__


set ENABLED_LSH224=/D__LSH224__
set ENABLED_LSH256=/D__LSH256__
set ENABLED_LSH384=/D__LSH384__
set ENABLED_LSH512=/D__LSH512__

set ENABLED_SM3=/D__SM3__
set ENABLED_WHIRLPOOL=/D__WHIRLPOOL__

set ENABLED_CMAC=/D__CMAC__
set ENABLED_CBCMAC=/D__CBCMAC__
set ENABLED_DMAC=/D__DMAC__
set ENABLED_GMAC=/D__GMAC__
set ENABLED_HMAC=/D__HMAC__
set ENABLED_POLY1305=/D__POLY1305__
set ENABLED_TWOTRACK=/D__TWOTRACK__
set ENABLED_VMAC=/D__VMAC__



set UTIL_CPP=util.cpp

IF NOT EXIST %SQLITE% goto sqlite_ne
IF NOT EXIST %SQLITE_DIR% goto sqlite_dir_ne
IF NOT EXIST %SQLITE_INC% goto sqlite_inc_ne
IF NOT EXIST %SQLITE_LIB% goto sqlite_lib_ne
IF NOT EXIST %CRYPTOPP_DIR% goto cryptopp_dir_ne
IF NOT EXIST %CRYPTOPP_INC% goto cryptopp_inc_ne
IF NOT EXIST %CRYPTOPP_LIB% goto cryptopp_lib_ne
IF NOT EXIST %TEST_FUNCTIONS% goto test_funcs_ne

IF NOT EXIST %HASHING_C% goto hashing_file_ne
IF NOT EXIST %CRYPTO_HASHING_CPP% goto crypto_file_ne
IF NOT EXIST %CRYPTO_HASHING_BLOB_CPP% goto crypto_blob_file_ne
IF NOT EXIST %CRYPTO_MAC_CPP% goto crypto_mac_file_ne
IT NOT EXIST %CRYPTO_MAC_BLOB_CPP% goto crypto_mac_blob_file_ne
IF NOT EXIST %UTIL_CPP% goto util_cpp_ne
IF NOT EXIST %SQLITE_LIB%\%SQLITE_LIB_FILE% goto sqlite_lib_file_ne
IF NOT EXIST %CRYPTOPP_LIB%\%CRYPTOPP_LIB_FILE% goto crypto_lib_file_ne

REM the conditional compilation above if REM d out should appear here as empty strings and therefore not defined
REM __ALL__ condition for tests does not currently work and will be left until the very end if at all except for the compilation
REM TODO: Add conditional compilation for mac functions and the catch all __USE_BLOB__ maybe __USE_MAC__

echo cl -Zi /GS /RTC1 %HASHING_C% %CRYPTO_HASHING_CPP% %CRYPTO_HASHING_BLOB_CPP% %CRYPTO_MAC_CPP% %CRYPTO_MAC_BLOB_CPP% %UTIL_CPP% /EHsc -I %SQLITE_INC% -I %CRYPTOPP_INC% %CRYPTOPP% %ENABLED_MD2% %ENABLED_MD4% %ENABLED_MD5% %ENABLED_SHA1% %ENABLED_SHA224% %ENABLED_SHA256% %ENABLED_SHA384% %ENABLED_SHA512% %ENABLED_SHA3224% %ENABLED_SHA3256% %ENABLED_SHA3384% %ENABLED_SHA3512% %ENABLED_RIPEMD128% %ENABLED_RIPEMD160% %ENABLED_RIPEMD256% %ENABLED_RIPEMD320% %ENABLED_BLAKE2B% %ENABLED_BLAKE2S% %ENABLED_TIGER% %ENABLED_SHAKE128% %ENABLED_SHAKE256% %ENABLED_SIPHASH64% %ENABLED_SIPHASH128% %ENABLED_LSH224% %ENABLED_LSH256% %ENABLED_LSH384% %ENABLED_LSH512% %ENABLED_SM3% %ENABLED_WHIRLPOOL% %ENABLED_USE_BLOB% %ENABLED_USE_MAC% %ENABLED_CMAC% %ENABLED_CBCMAC% %ENABLED_DMAC% %ENABLED_GMAC% %ENABLED_HMAC% %ENABLED_POLY1305% %ENABLED_TWOTRACK% %ENABLED_VMAC% -link /MACHINE:X64 -LIBPATH:%SQLITE_LIB% -LIBPATH:%CRYPTOPP_LIB%  sqlite3.lib cryptlib.lib kernel32.lib libcpmt.lib libcmt.lib libucrt.lib libvcruntime.lib -dll -out:hashing.dll
cl -Zi /GS /RTC1 %HASHING_C% %CRYPTO_HASHING_CPP% %CRYPTO_HASHING_BLOB_CPP% %CRYPTO_MACCPP% %CRYPTO_MAC_BLOB_CPP% %UTIL_CPP% /EHsc -I %SQLITE_INC% -I %CRYPTOPP_INC% %CRYPTOPP% %ENABLED_MD2% %ENABLED_MD4% %ENABLED_MD5% %ENABLED_SHA1% %ENABLED_SHA224% %ENABLED_SHA256% %ENABLED_SHA384% %ENABLED_SHA512% %ENABLED_SHA3224% %ENABLED_SHA3256% %ENABLED_SHA3384% %ENABLED_SHA3512% %ENABLED_RIPEMD128% %ENABLED_RIPEMD160% %ENABLED_RIPEMD256% %ENABLED_RIPEMD320% %ENABLED_BLAKE2B% %ENABLED_BLAKE2S% %ENABLED_TIGER% %ENABLED_SHAKE128% %ENABLED_SHAKE256% %ENABLED_SIPHASH64% %ENABLED_SIPHASH128% %ENABLED_LSH224% %ENABLED_LSH256% %ENABLED_LSH384% %ENABLED_LSH512% %ENABLED_SM3% %ENABLED_WHIRLPOOL% %ENABLED_USE_BLOB% %ENABLED_USE_MAC% %ENABLED_CMAC% %ENABLED_CBCMAC% %ENABLED_DMAC% %ENABLED_GMAC% %ENABLED_HMAC% %ENABLED_POLY1305% %ENABLED_TWOTRACK% %ENABLED_VMAC% -link /MACHINE:X64 -LIBPATH:%SQLITE_LIB% -LIBPATH:%CRYPTOPP_LIB% sqlite3.lib cryptlib.lib kernel32.lib libcpmt.lib libcmt.lib libucrt.lib libvcruntime.lib -dll -out:hashing.dll

REM "c:\Users\fliei\sources\repository\sqlite"
REM "c:\fliei\sources\repository\cryptopp"

if NOT "%ERRORLEVEL%"=="0" goto Failed
IF EXIST hashing.dll copy /y hashing.dll %SQLITE_DIR%
IF EXIST hashing.lib copy /y hashing.lib %SQLITE_DIR%
IF EXIST hashing.exp copy /y *.exp %SQLITE_DIR%
IF EXIST hashing.pdb copy /y *.pdb %SQLITE_DIR%

echo .load hashing|..\sqlite\sqlite3.exe 
if NOT "%ERRORLEVEL%"=="0" goto Failed

echo:
echo Test Hash Ping Functions
goto test_ping_exist
:after_test_ping_exist

echo:
echo Test Hash Info Module
goto test_hash_info_exist
:after_test_hash_info_exist


echo:
echo Test Hash Sizes Module
goto test_hash_sizes_exist
:after_test_hash_sizes_exist

echo:
echo Test Md2 Functions
goto test_md2_exist
:after_test_md2_exist

echo:
echo Test Md4 Functions
goto test_md4_exist
:after_test_md4_exist

echo:
echo Test Md5 Functions
goto test_md5_exist
:after_test_md5_exist

echo:
echo Test Sha1 Functions
goto test_sha1_exist
:after_test_sha1_exist

echo:
echo Test Sha224 Functions
goto test_sha224_exist
:after_test_sha224_exist

echo:
echo Test Sha256 Functions
goto test_sha256_exist
:after_test_sha256_exist

echo:
echo Test Sha384 Functions
goto test_sha384_exist
:after_test_sha384_exist

echo:
echo Test Sha512 Functions
goto test_sha512_exist
:after_test_sha512_exist

echo:
echo Test Sha3 224 Functions
goto test_sha3224_exist
:after_test_sha3224_exist

echo:
echo Test Sha3 256 Functions
goto test_sha3256_exist
:after_test_sha3256_exist

echo:
echo Test Sha3 384 Functions
goto test_sha3384_exist
:after_test_sha3384_exist

echo:
echo Test Sha3 512 Functions
goto test_sha3512_exist
:after_test_sha3512_exist

echo:
echo Test RipeMD128 Functions
goto test_ripemd128_exist
:after_test_ripemd128_exist

echo:
echo Test RipeMD160 Functions
goto test_ripemd160_exist
:after_test_ripemd160_exist

echo:
echo Test RipeMD256 Functions
goto test_ripemd256_exist
:after_test_ripemd256_exist

echo:
echo Test RipeMD320 Functions
goto test_ripemd320_exist
:after_test_ripemd320_exist

echo:
echo Test Blake2B Functions
goto test_blake2b_exist
:after_test_blake2b_exist

echo:
echo Test Blake2S Functions
goto test_blake2s_exist
:after_test_blake2s_exist

echo:
echo Test Tiger Functions
goto test_tiger_exist
:after_test_tiger_exist

echo:
echo Test Shake128 Functions
goto test_shake128_exist
:after_test_shake128_exist

echo:
echo Test Shake256 Functions
goto test_shake256_exist
:after_test_shake256_exist

echo:
echo Test SipHash64 Functions
goto test_siphash64_exist
:after_test_siphash64_exist

echo:
echo Test SipHash128 Functions
goto test_siphash128_exist
:after_test_siphash128_exist

echo:
echo Test Lsh224 Functions
goto test_lsh224_exist
:after_test_lsh224_exist

echo:
echo Test Lsh256 Functions
goto test_lsh256_exist
:after_test_lsh256_exist

echo:
echo Test Lsh384 Functions
goto test_lsh384_exist
:after_test_lsh384_exist

echo:
echo Test Lsh512 Functions
goto test_lsh512_exist
:after_test_lsh512_exist

echo:
echo Test Sm3 Functions
goto test_sm3_exist
:after_test_sm3_exist

echo:
echo Test Whirlpool Functions
goto test_whirlpool_exist
:after_test_whirlpool_exist

REM for /f %%A IN (test_functions.txt) do echo .load hashing>test%%A.sql && echo select %%A('')>>test%%A.sql && ..\sqlite\sqlite3.exe < test%%A.sql>result%%A.log && echo Testing %%A && type result%%A.log && del result%%A.log

goto Done

:Failed
echo Failed to build Done
exit /b 1

:Done
echo Done
exit /b 0

:sqlite_ne
echo Sqlite Executable [%SQLITE%] does not exist

:sqlite_dir_ne
echo Sqlite Directory [%SQLITE_DIR%] does not exist
exit /b 1

:sqlite_inc_ne
echo Sqlite Inc Directory [%SQLITE_INC%] does not exist
exit /b 1

:sqlite_lib_ne
echo Sqlite Lib Directory [%SQLITE_LIB%] does not exist
exit /b 1

:cryptopp_dir_ne
echo Crypto++ Directory [%CRYPTOPP_DIR%] does not exist
exit /b 1

:cryptopp_inc_ne
echo Crypto++ Inc Directory [%CRYPTOPP_INC%] does not exist
exit /b 1

:cryptopp_lib_ne
echo Crypto++ Lib Directory [%CRYPTOPP_LIB%] does not exist
exit /b 1

:test_funcs_ne
echo Test Functions file: [%FUNCTIONS%] does not exist
exit /b 1

:hashing_file_ne
echo source file: [%HASHING%] does not exist
exit /b 1

:crypto_file_ne
echo source file: [%CRYPTO_HASHING_CPP%] does not exist
exit /b 1

:crypto_blob_file_ne
echo source file: [%CRYPTO_HASHING_BLOB_CPP%] does not exist
exit /b 1

:crypto_mac_file_ne
echo source file: [%CRYPTO_MAC_CPP%] does not exist
exit /b 1

:goto crypto_mac_blob_file_ne
echo source file: [%CRYPTO_MAC_BLOB_CPP%] does not exits
exit /b 

:util_cpp_ne
echo source file: [%UTIL_CPP%] does not exist
exit /b 1


:sqlite_lib_file_ne
echo lib file: [%SQLITE_LIB%\%SQLITE_LIB_FILE%] does not exist
exit /b 1

:crypto_lib_file_ne
echo lib file: [%CRYPTOPP_LIB%\%CRYPTOPP_LIB_FILE%] does not exist
exit /b 1

:test_fail
echo Test Failed
exit /b 1

:test_ping_exist

echo Testing Ping Function Exists
echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='hash_ping';>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe < test.sql >result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="hash_ping" set HASH_PING_EXISTS=1
IF "%HASH_PING_EXISTS%"=="1" echo hash_ping exists
IF NOT "%HASH_PING_EXISTS%"=="1" goto test_fail

echo Testing Ping function
echo .load hashing>test.sql
echo select hash_ping();>>test.sql
echo .quit>>test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_ping_exist

:test_hash_info_exist

echo Testing hash_info Function Exists
echo .load hashing>test.sql
echo select * FROM pragma_module_list WHERE name='hash_info';>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe < test.sql >result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="hash_info" set HASH_INFO_EXISTS=1
IF "%HASH_INFO_EXISTS%"=="1" echo hash_info exists
IF NOT "%HASH_INFO_EXISTS%"=="1" goto test_fail


echo Testing hash_info function
echo .load hashing>test.sql
echo select * FROM hash_info();>>test.sql
echo .quit>>test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_hash_info_exist

:test_hash_sizes_exist

echo Testing hash_sizes Function Exists
echo .load hashing>test.sql
echo select * FROM pragma_module_list WHERE name='hash_sizes';>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe < test.sql >result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="hash_sizes" set HASH_SIZES_EXISTS=1
IF "%HASH_SIZES_EXISTS%"=="1" echo hash_sizes exists
IF NOT "%HASH_SIZES_EXISTS%"=="1" goto test_fail

echo Testing hash_sizes function
echo .load hashing>test.sql
echo select * FROM hash_sizes();>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_hash_sizes_exist

:test_md2_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='md2';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_MD2%"=="" goto after_test_md2_exist
echo Md2 Enabled - testing for md2 function
IF NOT "%ENABLED_MD2%"=="" echo "MD2 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="md2" set MD2_EXISTS=1
IF "%MD2_EXISTS%"=="1" echo md2 exists
IF NOT "%MD2_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select md2('''');';>>test.sql
echo select md2('');>>test.sql
echo select 'select md2(''a'');';>>test.sql
echo select md2('a');>>test.sql
echo select 'select md2(''this is a message'');';>>test.sql
echo select md2('this is a message');>>test.sql
echo select 'select md2(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select md2('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log


IF "%ENABLED_USE_BLOB%"==""  goto after_test_md2_exist

echo:
echo Testing md2blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select md2blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

IF "%ENABLED_USE_MAC%"=="" goto after_test_md2_exist

echo .load hashing>test.sql
echo select 'select macmd2(''00000000000000000000000000000000'','''',1);';>>test.sql
echo select macmd2('00000000000000000000000000000000','',1);>>test.sql
echo select 'select macmd2(''00000000000000000000000000000000'',''a'',1);';>>test.sql
echo select macmd2('00000000000000000000000000000000','a',1);>>test.sql
echo select 'select macmd2(''00000000000000000000000000000000'',''this is a message'',1);';>>test.sql
echo select macmd2('00000000000000000000000000000000','this is a message',1);>>test.sql
echo select 'select macmd2(''00000000000000000000000000000000'',''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'',1);';>>test.sql
echo select macmd2('00000000000000000000000000000000','1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890',1);>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

echo:
echo Testing md2macblob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select macmd2blob('main','test','test',1,'00000000000000000000000000000000',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_md2_exist

:test_md4_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='md4';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_MD4%"=="" goto after_test_md4_exist
echo Md4 Enabled - testing for md4 function
IF NOT "%ENABLED_MD4%"=="" echo "MD4 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="md4" set MD4_EXISTS=1
IF "%MD4_EXISTS%"=="1" echo md4 exists
IF NOT "%MD4_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select md4('''');';>>test.sql
echo select md4('');>>test.sql
echo select 'select md4(''a'');';>>test.sql
echo select md4('a');>>test.sql
echo select 'select md4(''this is a message'');';>>test.sql
echo select md4('this is a message');>>test.sql
echo select 'select md4(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select md4('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_md4_exist

echo:
echo Testing md4blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select md4blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

IF "%ENABLED_USE_MAC%"=="" goto after_test_md4_exist

echo .load hashing>test.sql
echo select 'select macmd4(''00000000000000000000000000000000'','''',1);';>>test.sql
echo select macmd4('00000000000000000000000000000000','',1);>>test.sql
echo select 'select macmd4(''00000000000000000000000000000000'',''a'',1);';>>test.sql
echo select macmd4('00000000000000000000000000000000','a',1);>>test.sql
echo select 'select macmd4(''00000000000000000000000000000000'',''this is a message'',1);';>>test.sql
echo select macmd4('00000000000000000000000000000000','this is a message',1);>>test.sql
echo select 'select macmd4(''00000000000000000000000000000000'',''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'',1);';>>test.sql
echo select macmd4('00000000000000000000000000000000','1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890',1);>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

echo:
echo Testing md4macblob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select macmd4blob('main','test','test',1,'00000000000000000000000000000000',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_md4_exist

:test_md5_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='md5';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_MD5%"=="" goto after_test_md5_exist
echo Md5 Enabled - testing for md5 function
IF NOT "%ENABLED_MD5%"=="" echo "MD5 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="md5" set MD5_EXISTS=1
IF "%MD5_EXISTS%"=="1" echo md5 exists
IF NOT "%MD5_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select md5('''');';>>test.sql
echo select md5('');>>test.sql
echo select 'select md5(''a'');';>>test.sql
echo select md5('a');>>test.sql
echo select 'select md5(''this is a message'');';>>test.sql
echo select md5('this is a message');>>test.sql
echo select 'select md5(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select md5('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_md5_exist

echo:
echo Testing md5blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select md5blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

IF "%ENABLED_USE_MAC%"=="" goto after_test_md5_exist

echo .load hashing>test.sql
echo select 'select macmd5(''00000000000000000000000000000000'','''',1);';>>test.sql
echo select macmd5('00000000000000000000000000000000','',1);>>test.sql
echo select 'select macmd5(''00000000000000000000000000000000'',''a'',1);';>>test.sql
echo select macmd5('00000000000000000000000000000000','a',1);>>test.sql
echo select 'select macmd5(''00000000000000000000000000000000'',''this is a message'',1);';>>test.sql
echo select macmd5('00000000000000000000000000000000','this is a message',1);>>test.sql
echo select 'select macmd5(''00000000000000000000000000000000'',''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'',1);';>>test.sql
echo select macmd5('00000000000000000000000000000000','1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890',1);>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

echo:
echo Testing md5macblob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select macmd5blob('main','test','test',1,'00000000000000000000000000000000',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_md5_exist

:test_sha1_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='sha1';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_SHA1%"=="" goto after_test_sha1_exist
echo Sha1 Enabled - testing for sha1 function
IF NOT "%ENABLED_SHA1%"=="" echo "SHA1 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="sha1" set SHA1_EXISTS=1
IF "%SHA1_EXISTS%"=="1" echo sha1 exists
IF NOT "%SHA1_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select sha1('''');';>>test.sql
echo select sha1('');>>test.sql
echo select 'select sha1(''a'');';>>test.sql
echo select sha1('a');>>test.sql
echo select 'select sha1(''this is a message'');';>>test.sql
echo select sha1('this is a message');>>test.sql
echo select 'select sha1(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select sha1('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_sha1_exist

echo Testing sha1blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select sha1blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

IF "%ENABLED_USE_MAC%"=="" goto after_test_sha1_exist

echo .load hashing>test.sql
echo select 'select macsha1(''00000000000000000000000000000000'','''',1);';>>test.sql
echo select macsha1('00000000000000000000000000000000','',1);>>test.sql
echo select 'select macsha1(''00000000000000000000000000000000'',''a'',1);';>>test.sql
echo select macsha1('00000000000000000000000000000000','a',1);>>test.sql
echo select 'select macsha1(''00000000000000000000000000000000'',''this is a message'',1);';>>test.sql
echo select macsha1('00000000000000000000000000000000','this is a message',1);>>test.sql
echo select 'select macsha1(''00000000000000000000000000000000'',''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'',1);';>>test.sql
echo select macsha1('00000000000000000000000000000000','1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890',1);>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

echo:
echo Testing sha1macblob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select macsha1blob('main','test','test',1,'00000000000000000000000000000000',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_sha1_exist

:test_sha224_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='sha224';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_SHA224%"=="" goto after_test_sha224_exist
echo Sha224 Enabled - testing for sha224 function
IF NOT "%ENABLED_SHA224%"=="" echo "SHA224 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="sha224" set SHA224_EXISTS=1
IF "%SHA224_EXISTS%"=="1" echo sha224 exists
IF NOT "%SHA224_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select sha224('''');';>>test.sql
echo select sha224('');>>test.sql
echo select 'select sha224(''a'');';>>test.sql
echo select sha224('a');>>test.sql
echo select 'select sha224(''this is a message'');';>>test.sql
echo select sha224('this is a message');>>test.sql
echo select 'select sha224(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select sha224('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_sha224_exist

echo:
echo Testing sha224blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select sha224blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

IF "%ENABLED_USE_MAC%"=="" goto after_test_sha224_exist

echo .load hashing>test.sql
echo select 'select macsha224(''00000000000000000000000000000000'','''',1);';>>test.sql
echo select macsha224('00000000000000000000000000000000','',1);>>test.sql
echo select 'select macsha224(''00000000000000000000000000000000'',''a'',1);';>>test.sql
echo select macsha224('00000000000000000000000000000000','a',1);>>test.sql
echo select 'select macsha224(''00000000000000000000000000000000'',''this is a message'',1);';>>test.sql
echo select macsha224('00000000000000000000000000000000','this is a message',1);>>test.sql
echo select 'select macsha224(''00000000000000000000000000000000'',''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'',1);';>>test.sql
echo select macsha224('00000000000000000000000000000000','1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890',1);>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

echo:
echo Testing sha224macblob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select macsha224blob('main','test','test',1,'00000000000000000000000000000000',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_sha224_exist

:test_sha256_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='sha256';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_SHA256%"=="" goto after_test_sha256_exist
echo Sha256 Enabled - testing for sha256 function
IF NOT "%ENABLED_SHA256%"=="" echo "SHA256 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="sha256" set SHA256_EXISTS=1
IF "%SHA256_EXISTS%"=="1" echo sha256 exists
IF NOT "%SHA256_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select sha256('''');';>>test.sql
echo select sha256('');>>test.sql
echo select 'select sha256(''a'');';>>test.sql
echo select sha256('a');>>test.sql
echo select 'select sha256(''this is a message'');';>>test.sql
echo select sha256('this is a message');>>test.sql
echo select 'select sha256(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select sha256('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_sha256_exist

echo:
echo Testing sha256blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select sha256blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

IF "%ENABLED_USE_MAC%"=="" goto after_test_sha256_exist

echo .load hashing>test.sql
echo select 'select macsha256(''00000000000000000000000000000000'','''',1);';>>test.sql
echo select macsha256('00000000000000000000000000000000','',1);>>test.sql
echo select 'select macsha256(''00000000000000000000000000000000'',''a'',1);';>>test.sql
echo select macsha256('00000000000000000000000000000000','a',1);>>test.sql
echo select 'select macsha256(''00000000000000000000000000000000'',''this is a message'',1);';>>test.sql
echo select macsha256('00000000000000000000000000000000','this is a message',1);>>test.sql
echo select 'select macsha256(''00000000000000000000000000000000'',''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'',1);';>>test.sql
echo select macsha256('00000000000000000000000000000000','1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890',1);>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

echo:
echo Testing sha256macblob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select macsha256blob('main','test','test',1,'00000000000000000000000000000000',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log


goto after_test_sha256_exist

:test_sha384_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='sha384';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_SHA384%"=="" goto after_test_sha384_exist
echo Sha384 Enabled - testing for sha384 function
IF NOT "%ENABLED_SHA384%"=="" echo "SHA384 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="sha384" set SHA384_EXISTS=1
IF "%SHA384_EXISTS%"=="1" echo sha384 exists
IF NOT "%SHA384_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select sha384('''');';>>test.sql
echo select sha384('');>>test.sql
echo select 'select sha384(''a'');';>>test.sql
echo select sha384('a');>>test.sql
echo select 'select sha384(''this is a message'');';>>test.sql
echo select sha384('this is a message');>>test.sql
echo select 'select sha384(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select sha384('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_sha384_exist

echo:
echo Testing sha384blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select sha384blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

IF "%ENABLED_USE_MAC%"=="" goto after_test_sha384_exist

echo .load hashing>test.sql
echo select 'select macsha384(''00000000000000000000000000000000'','''',1);';>>test.sql
echo select macsha384('00000000000000000000000000000000','',1);>>test.sql
echo select 'select macsha384(''00000000000000000000000000000000'',''a'',1);';>>test.sql
echo select macsha384('00000000000000000000000000000000','a',1);>>test.sql
echo select 'select macsha384(''00000000000000000000000000000000'',''this is a message'',1);';>>test.sql
echo select macsha384('00000000000000000000000000000000','this is a message',1);>>test.sql
echo select 'select macsha384(''00000000000000000000000000000000'',''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'',1);';>>test.sql
echo select macsha384('00000000000000000000000000000000','1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890',1);>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

echo:
echo Testing sha384macblob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select macsha384blob('main','test','test',1,'00000000000000000000000000000000',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log


goto after_test_sha384_exist

:test_sha512_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='sha512';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_SHA512%"=="" goto after_test_sha512_exist
echo Sha512 Enabled - testing for sha512 function
IF NOT "%ENABLED_SHA512%"=="" echo "SHA512 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="sha512" set SHA512_EXISTS=1
IF "%SHA512_EXISTS%"=="1" echo sha512 exists
IF NOT "%SHA512_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select sha512('''');';>>test.sql
echo select sha512('');>>test.sql
echo select 'select sha512(''a'');';>>test.sql
echo select sha512('a');>>test.sql
echo select 'select sha512(''this is a message'');';>>test.sql
echo select sha512('this is a message');>>test.sql
echo select 'select sha512(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select sha512('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_sha512_exist

echo:
echo Testing sha512blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select sha512blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

IF "%ENABLED_USE_MAC%"=="" goto after_test_sha512_exist

echo .load hashing>test.sql
echo select 'select macsha512(''00000000000000000000000000000000'','''',1);';>>test.sql
echo select macsha512('00000000000000000000000000000000','',1);>>test.sql
echo select 'select macsha512(''00000000000000000000000000000000'',''a'',1);';>>test.sql
echo select macsha512('00000000000000000000000000000000','a',1);>>test.sql
echo select 'select macsha512(''00000000000000000000000000000000'',''this is a message'',1);';>>test.sql
echo select macsha512('00000000000000000000000000000000','this is a message',1);>>test.sql
echo select 'select macsha512(''00000000000000000000000000000000'',''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'',1);';>>test.sql
echo select macsha512('00000000000000000000000000000000','1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890',1);>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

echo:
echo Testing sha512macblob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select macsha512blob('main','test','test',1,'00000000000000000000000000000000',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_sha512_exist


:test_sha3224_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='sha3224';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_SHA3224%"=="" goto after_test_sha3224_exist
echo Sha3224 Enabled - testing for sha3224 function
IF NOT "%ENABLED_SHA3224%"=="" echo "SHA3224 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="sha3224" set SHA3224_EXISTS=1
IF "%SHA3224_EXISTS%"=="1" echo sha3224 exists
IF NOT "%SHA3224_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select sha3224('''');';>>test.sql
echo select sha3224('');>>test.sql
echo select 'select sha3224(''a'');';>>test.sql
echo select sha3224('a');>>test.sql
echo select 'select sha3224(''this is a message'');';>>test.sql
echo select sha3224('this is a message');>>test.sql
echo select 'select sha3224(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select sha3224('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_sha3224_exist

echo:
echo Testing sha3224blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select sha3224blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

IF "%ENABLED_USE_MAC%"=="" goto after_test_sha3224_exist

echo .load hashing>test.sql
echo select 'select macsha3224(''00000000000000000000000000000000'','''',1);';>>test.sql
echo select macsha3224('00000000000000000000000000000000','',1);>>test.sql
echo select 'select macsha3224(''00000000000000000000000000000000'',''a'',1);';>>test.sql
echo select macsha3224('00000000000000000000000000000000','a',1);>>test.sql
echo select 'select macsha3224(''00000000000000000000000000000000'',''this is a message'',1);';>>test.sql
echo select macsha3224('00000000000000000000000000000000','this is a message',1);>>test.sql
echo select 'select macsha3224(''00000000000000000000000000000000'',''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'',1);';>>test.sql
echo select macsha3224('00000000000000000000000000000000','1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890',1);>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

echo:
echo Testing sha3224macblob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select macsha3224blob('main','test','test',1,'00000000000000000000000000000000',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log



goto after_test_sha3224_exist

:test_sha3256_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='sha3256';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_SHA3256%"=="" goto after_test_sha3256_exist
echo Sha3256 Enabled - testing for sha3256 function
IF NOT "%ENABLED_SHA3256%"=="" echo "SHA3256 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="sha3256" set SHA3256_EXISTS=1
IF "%SHA3256_EXISTS%"=="1" echo sha3256 exists
IF NOT "%SHA3256_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select sha3256('''');';>>test.sql
echo select sha3256('');>>test.sql
echo select 'select sha3256(''a'');';>>test.sql
echo select sha3256('a');>>test.sql
echo select 'select sha3256(''this is a message'');';>>test.sql
echo select sha3256('this is a message');>>test.sql
echo select 'select sha3256(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select sha3256('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_sha3256_exist

echo:
echo Testing sha3256blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select sha3256blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

IF "%ENABLED_USE_MAC%"=="" goto after_test_sha3256_exist

echo .load hashing>test.sql
echo select 'select macsha3256(''00000000000000000000000000000000'','''',1);';>>test.sql
echo select macsha3256('00000000000000000000000000000000','',1);>>test.sql
echo select 'select macsha3256(''00000000000000000000000000000000'',''a'',1);';>>test.sql
echo select macsha3256('00000000000000000000000000000000','a',1);>>test.sql
echo select 'select macsha3256(''00000000000000000000000000000000'',''this is a message'',1);';>>test.sql
echo select macsha3256('00000000000000000000000000000000','this is a message',1);>>test.sql
echo select 'select macsha3256(''00000000000000000000000000000000'',''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'',1);';>>test.sql
echo select macsha3256('00000000000000000000000000000000','1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890',1);>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

echo:
echo Testing sha3256macblob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select macsha3256blob('main','test','test',1,'00000000000000000000000000000000',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log


goto after_test_sha3256_exist

:test_sha3384_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='sha3384';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_SHA3384%"=="" goto after_test_sha3384_exist
echo Sha3384 Enabled - testing for sha3384 function
IF NOT "%ENABLED_SHA3384%"=="" echo "SHA3384 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="sha3384" set SHA3384_EXISTS=1
IF "%SHA3384_EXISTS%"=="1" echo sha3384 exists
IF NOT "%SHA3384_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select sha3384('''');';>>test.sql
echo select sha3384('');>>test.sql
echo select 'select sha3384(''a'');';>>test.sql
echo select sha3384('a');>>test.sql
echo select 'select sha3384(''this is a message'');';>>test.sql
echo select sha3384('this is a message');>>test.sql
echo select 'select sha3384(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select sha3384('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_sha3384_exist

echo:
echo Testing sha3384blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select sha3384blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log


IF "%ENABLED_USE_MAC%"=="" goto after_test_sha3384_exist

echo .load hashing>test.sql
echo select 'select macsha3384(''00000000000000000000000000000000'','''',1);';>>test.sql
echo select macsha3384('00000000000000000000000000000000','',1);>>test.sql
echo select 'select macsha3384(''00000000000000000000000000000000'',''a'',1);';>>test.sql
echo select macsha3384('00000000000000000000000000000000','a',1);>>test.sql
echo select 'select macsha3384(''00000000000000000000000000000000'',''this is a message'',1);';>>test.sql
echo select macsha3384('00000000000000000000000000000000','this is a message',1);>>test.sql
echo select 'select macsha3384(''00000000000000000000000000000000'',''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'',1);';>>test.sql
echo select macsha3384('00000000000000000000000000000000','1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890',1);>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

echo:
echo Testing sha3384macblob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select macsha3384blob('main','test','test',1,'00000000000000000000000000000000',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_sha3384_exist

:test_sha3512_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='sha3512';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_SHA3512%"=="" goto after_test_sha3512_exist
echo Sha3512 Enabled - testing for sha3512 function
IF NOT "%ENABLED_SHA3512%"=="" echo "SHA3512 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="sha3512" set SHA3512_EXISTS=1
IF "%SHA3512_EXISTS%"=="1" echo sha3512 exists
IF NOT "%SHA3512_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select sha3512('''');';>>test.sql
echo select sha3512('');>>test.sql
echo select 'select sha3512(''a'');';>>test.sql
echo select sha3512('a');>>test.sql
echo select 'select sha3512(''this is a message'');';>>test.sql
echo select sha3512('this is a message');>>test.sql
echo select 'select sha3512(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select sha3512('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_sha3512_exist

echo:
echo Testing sha3512blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select sha3512blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

IF "%ENABLED_USE_MAC%"=="" goto after_test_sha3512_exist

echo .load hashing>test.sql
echo select 'select macsha3512(''00000000000000000000000000000000'','''',1);';>>test.sql
echo select macsha3512('00000000000000000000000000000000','',1);>>test.sql
echo select 'select macsha3512(''00000000000000000000000000000000'',''a'',1);';>>test.sql
echo select macsha3512('00000000000000000000000000000000','a',1);>>test.sql
echo select 'select macsha3512(''00000000000000000000000000000000'',''this is a message'',1);';>>test.sql
echo select macsha3512('00000000000000000000000000000000','this is a message',1);>>test.sql
echo select 'select macsha3512(''00000000000000000000000000000000'',''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'',1);';>>test.sql
echo select macsha3512('00000000000000000000000000000000','1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890',1);>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

echo:
echo Testing sha3512macblob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select macsha3512blob('main','test','test',1,'00000000000000000000000000000000',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_sha3512_exist

:test_ripemd128_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='ripemd128';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_RIPEMD128%"=="" goto after_test_ripemd128_exist
echo RipeMD128 Enabled - testing for ripemd128 function
IF NOT "%ENABLED_RIPEMD128%"=="" echo "RIPEMD128 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="ripemd128" set RIPEMD128_EXISTS=1
IF "%RIPEMD128_EXISTS%"=="1" echo ripemd128 exists
IF NOT "%RIPEMD128_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select ripemd128('''');';>>test.sql
echo select ripemd128('');>>test.sql
echo select 'select ripemd128(''a'');';>>test.sql
echo select ripemd128('a');>>test.sql
echo select 'select ripemd128(''this is a message'');';>>test.sql
echo select ripemd128('this is a message');>>test.sql
echo select 'select ripemd128(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select ripemd128('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_ripemd128_exist

echo:
echo Testing ripemd128blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select ripemd128blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

IF "%ENABLED_USE_MAC%"=="" goto after_test_ripemd160_exist

echo .load hashing>test.sql
echo select 'select macripemd160(''00000000000000000000000000000000'','''',1);';>>test.sql
echo select macripemd160('00000000000000000000000000000000','',1);>>test.sql
echo select 'select macripemd160(''00000000000000000000000000000000'',''a'',1);';>>test.sql
echo select macripemd160('00000000000000000000000000000000','a',1);>>test.sql
echo select 'select macripemd160(''00000000000000000000000000000000'',''this is a message'',1);';>>test.sql
echo select macripemd160('00000000000000000000000000000000','this is a message',1);>>test.sql
echo select 'select macripemd160(''00000000000000000000000000000000'',''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'',1);';>>test.sql
echo select macripemd160('00000000000000000000000000000000','1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890',1);>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

echo:
echo Testing ripemd160macblob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select macripemd160blob('main','test','test',1,'00000000000000000000000000000000',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_ripemd128_exist

:test_ripemd160_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='ripemd160';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_RIPEMD160%"=="" goto after_test_ripemd160_exist
echo RipeMD160 Enabled - testing for ripemd160 function
IF NOT "%ENABLED_RIPEMD160%"=="" echo "RIPEMD160 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="ripemd160" set RIPEMD160_EXISTS=1
IF "%RIPEMD160_EXISTS%"=="1" echo ripemd160 exists
IF NOT "%RIPEMD160_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select ripemd160('''');';>>test.sql
echo select ripemd160('');>>test.sql
echo select 'select ripemd160(''a'');';>>test.sql
echo select ripemd160('a');>>test.sql
echo select 'select ripemd160(''this is a message'');';>>test.sql
echo select ripemd160('this is a message');>>test.sql
echo select 'select ripemd160(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select ripemd160('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_ripemd160_exist

echo:
echo Testing ripemd160blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select ripemd160blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_ripemd160_exist

:test_ripemd256_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='ripemd256';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_RIPEMD256%"=="" goto after_test_ripemd256_exist
echo RipeMD256 Enabled - testing for ripemd256 function
IF NOT "%ENABLED_RIPEMD256%"=="" echo "RIPEMD256 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="ripemd256" set RIPEMD256_EXISTS=1
IF "%RIPEMD256_EXISTS%"=="1" echo ripemd256 exists
IF NOT "%RIPEMD256_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select ripemd256('''');';>>test.sql
echo select ripemd256('');>>test.sql
echo select 'select ripemd256(''a'');';>>test.sql
echo select ripemd256('a');>>test.sql
echo select 'select ripemd256(''this is a message'');';>>test.sql
echo select ripemd256('this is a message');>>test.sql
echo select 'select ripemd256(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select ripemd256('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_ripemd256_exist

echo:
echo Testing ripemd256blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select ripemd256blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

IF "%ENABLED_USE_MAC%"=="" goto after_test_ripemd256_exist

echo .load hashing>test.sql
echo select 'select macripemd256(''00000000000000000000000000000000'','''',1);';>>test.sql
echo select macripemd256('00000000000000000000000000000000','',1);>>test.sql
echo select 'select macripemd256(''00000000000000000000000000000000'',''a'',1);';>>test.sql
echo select macripemd256('00000000000000000000000000000000','a',1);>>test.sql
echo select 'select macripemd256(''00000000000000000000000000000000'',''this is a message'',1);';>>test.sql
echo select macripemd256('00000000000000000000000000000000','this is a message',1);>>test.sql
echo select 'select macripemd256(''00000000000000000000000000000000'',''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'',1);';>>test.sql
echo select macripemd256('00000000000000000000000000000000','1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890',1);>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

echo:
echo Testing ripemd256macblob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select macripemd256blob('main','test','test',1,'00000000000000000000000000000000',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log


goto after_test_ripemd256_exist

:test_ripemd320_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='ripemd320';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_RIPEMD320%"=="" goto after_test_ripemd320_exist
echo RipeMD320 Enabled - testing for ripemd320 function
IF NOT "%ENABLED_RIPEMD320%"=="" echo "RIPEMD320 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="ripemd320" set RIPEMD320_EXISTS=1
IF "%RIPEMD320_EXISTS%"=="1" echo ripemd320 exists
IF NOT "%RIPEMD320_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select ripemd320('''');';>>test.sql
echo select ripemd320('');>>test.sql
echo select 'select ripemd320(''a'');';>>test.sql
echo select ripemd320('a');>>test.sql
echo select 'select ripemd320(''this is a message'');';>>test.sql
echo select ripemd320('this is a message');>>test.sql
echo select 'select ripemd320(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select ripemd320('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_ripemd320_exist

echo:
echo Testing ripemd320blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select ripemd320blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

IF "%ENABLED_USE_MAC%"=="" goto after_test_ripemd320_exist

echo .load hashing>test.sql
echo select 'select macripemd320(''00000000000000000000000000000000'','''',1);';>>test.sql
echo select macripemd320('00000000000000000000000000000000','',1);>>test.sql
echo select 'select macripemd320(''00000000000000000000000000000000'',''a'',1);';>>test.sql
echo select macripemd320('00000000000000000000000000000000','a',1);>>test.sql
echo select 'select macripemd320(''00000000000000000000000000000000'',''this is a message'',1);';>>test.sql
echo select macripemd320('00000000000000000000000000000000','this is a message',1);>>test.sql
echo select 'select macripemd320(''00000000000000000000000000000000'',''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'',1);';>>test.sql
echo select macripemd320('00000000000000000000000000000000','1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890',1);>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

echo:
echo Testing ripemd320macblob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select macripemd320blob('main','test','test',1,'00000000000000000000000000000000',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log


exit /b 1
goto after_test_ripemd320_exist

:test_blake2b_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='blake2b';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_BLAKE2B%"=="" goto after_test_blake2b_exist
echo Blake2B Enabled - testing for blake2b function
IF NOT "%ENABLED_BLAKE2B%"=="" echo "BLAKE2B Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="blake2b" set BLAKE2B_EXISTS=1
IF "%BLAKE2B_EXISTS%"=="1" echo blake2b exists
IF NOT "%BLAKE2B_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select blake2b('''');';>>test.sql
echo select blake2b('');>>test.sql
echo select 'select blake2b(''a'');';>>test.sql
echo select blake2b('a');>>test.sql
echo select 'select blake2b(''this is a message'');';>>test.sql
echo select blake2b('this is a message');>>test.sql
echo select 'select blake2b(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select blake2b('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_blake2b_exist

echo:
echo Testing blake2bblob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select blake2bblob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_blake2b_exist

:test_blake2s_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='blake2s';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_BLAKE2S%"=="" goto after_test_blake2s_exist
echo Blake2S Enabled - testing for blake2s function
IF NOT "%ENABLED_BLAKE2S%"=="" echo "BLAKE2S Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="blake2s" set BLAKE2S_EXISTS=1
IF "%BLAKE2S_EXISTS%"=="1" echo blake2s exists
IF NOT "%BLAKE2S_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select blake2s('''');';>>test.sql
echo select blake2s('');>>test.sql
echo select 'select blake2s(''a'');';>>test.sql
echo select blake2s('a');>>test.sql
echo select 'select blake2s(''this is a message'');';>>test.sql
echo select blake2s('this is a message');>>test.sql
echo select 'select blake2s(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select blake2s('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_blake2b_exist

echo:
echo Testing blake2bblob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select blake2bblob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_blake2s_exist

:test_tiger_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='tiger';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_TIGER%"=="" goto after_test_tiger_exist
echo Tiger Enabled - testing for tiger function
IF NOT "%ENABLED_TIGER%"=="" echo "TIGER Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="tiger" set TIGER_EXISTS=1
IF "%TIGER_EXISTS%"=="1" echo tiger exists
IF NOT "%TIGER_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select tiger('''');';>>test.sql
echo select tiger('');>>test.sql
echo select 'select tiger(''a'');';>>test.sql
echo select tiger('a');>>test.sql
echo select 'select tiger(''this is a message'');';>>test.sql
echo select tiger('this is a message');>>test.sql
echo select 'select tiger(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select tiger('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_tiger_exist

echo:
echo Testing tigerblob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select tigerblob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_tiger_exist

:test_shake128_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='shake128';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_SHAKE128%"=="" goto after_test_shake128_exist
echo Shake128 Enabled - testing for shake128 function
IF NOT "%ENABLED_SHAKE128%"=="" echo "SHAKE128 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="shake128" set SHAKE128_EXISTS=1
IF "%SHAKE128_EXISTS%"=="1" echo shake128 exists
IF NOT "%SHAKE128_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select shake128('''');';>>test.sql
echo select shake128('');>>test.sql
echo select 'select shake128(''a'');';>>test.sql
echo select shake128('a');>>test.sql
echo select 'select shake128(''this is a message'');';>>test.sql
echo select shake128('this is a message');>>test.sql
echo select 'select shake128(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select shake128('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_shake128_exist

echo:
echo Testing shake128blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select shake128blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_shake128_exist

:test_shake256_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='shake256';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_SHAKE256%"=="" goto after_test_shake256_exist
echo Shake256 Enabled - testing for shake256 function
IF NOT "%ENABLED_SHAKE256%"=="" echo "SHAKE256 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="shake256" set SHAKE256_EXISTS=1
IF "%SHAKE256_EXISTS%"=="1" echo shake256 exists
IF NOT "%SHAKE256_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select shake256('''');';>>test.sql
echo select shake256('');>>test.sql
echo select 'select shake256(''a'');';>>test.sql
echo select shake256('a');>>test.sql
echo select 'select shake256(''this is a message'');';>>test.sql
echo select shake256('this is a message');>>test.sql
echo select 'select shake256(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select shake256('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_shake256_exist

echo:
echo Testing shake256blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select shake256blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_shake256_exist

:test_siphash64_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='siphash64';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_SIPHASH64%"=="" goto after_test_siphash64_exist
echo Siphash64 Enabled - testing for siphash64 function
IF NOT "%ENABLED_SIPHASH64%"=="" echo "SIPHASH64 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="siphash64" set SIPHASH64_EXISTS=1
IF "%SIPHASH64_EXISTS%"=="1" echo siphash64 exists
IF NOT "%SIPHASH64_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select siphash64('''');';>>test.sql
echo select siphash64('');>>test.sql
echo select 'select siphash64(''a'');';>>test.sql
echo select siphash64('a');>>test.sql
echo select 'select siphash64(''this is a message'');';>>test.sql
echo select siphash64('this is a message');>>test.sql
echo select 'select siphash64(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select siphash64('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_siphash64_exist

echo:
echo Testing siphash64blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select siphash64blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_siphash64_exist

:test_siphash128_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='siphash128';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_SIPHASH128%"=="" goto after_test_siphash128_exist
echo Siphash128 Enabled - testing for siphash128 function
IF NOT "%ENABLED_SIPHASH128%"=="" echo "SIPHASH128 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="siphash128" set SIPHASH128_EXISTS=1
IF "%SIPHASH128_EXISTS%"=="1" echo siphash128 exists
IF NOT "%SIPHASH128_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select siphash128('''');';>>test.sql
echo select siphash128('');>>test.sql
echo select 'select siphash128(''a'');';>>test.sql
echo select siphash128('a');>>test.sql
echo select 'select siphash128(''this is a message'');';>>test.sql
echo select siphash128('this is a message');>>test.sql
echo select 'select siphash128(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select siphash128('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_siphash128_exist

echo:
echo Testing siphash128blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select siphash128blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log


goto after_test_siphash128_exist

:test_lsh224_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='lsh224';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_LSH224%"=="" goto after_test_lsh224_exist
echo Lsh224 Enabled - testing for lsh224 function
IF NOT "%ENABLED_LSH224%"=="" echo "LSH224 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="lsh224" set LSH224_EXISTS=1
IF "%LSH224_EXISTS%"=="1" echo lsh224 exists
IF NOT "%LSH224_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select lsh224('''');';>>test.sql
echo select lsh224('');>>test.sql
echo select 'select lsh224(''a'');';>>test.sql
echo select lsh224('a');>>test.sql
echo select 'select lsh224(''this is a message'');';>>test.sql
echo select lsh224('this is a message');>>test.sql
echo select 'select lsh224(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select lsh224('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_lsh224_exist

echo:
echo Testing lsh224blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select lsh224blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log


goto after_test_lsh224_exist

:test_lsh256_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='lsh256';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_LSH256%"=="" goto after_test_lsh256_exist
echo Lsh256 Enabled - testing for lsh256 function
IF NOT "%ENABLED_LSH256%"=="" echo "LSH256 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="lsh256" set LSH256_EXISTS=1
IF "%LSH256_EXISTS%"=="1" echo lsh256 exists
IF NOT "%LSH256_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select lsh256('''');';>>test.sql
echo select lsh256('');>>test.sql
echo select 'select lsh256(''a'');';>>test.sql
echo select lsh256('a');>>test.sql
echo select 'select lsh256(''this is a message'');';>>test.sql
echo select lsh256('this is a message');>>test.sql
echo select 'select lsh256(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select lsh256('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_lsh256_exist

echo:
echo Testing lsh256blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select lsh256blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_lsh256_exist

:test_lsh384_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='lsh384';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_LSH384%"=="" goto after_test_lsh384_exist
echo Lsh384 Enabled - testing for lsh384 function
IF NOT "%ENABLED_LSH384%"=="" echo "LSH384 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="lsh384" set LSH384_EXISTS=1
IF "%LSH384_EXISTS%"=="1" echo lsh384 exists
IF NOT "%LSH384_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select lsh384('''');';>>test.sql
echo select lsh384('');>>test.sql
echo select 'select lsh384(''a'');';>>test.sql
echo select lsh384('a');>>test.sql
echo select 'select lsh384(''this is a message'');';>>test.sql
echo select lsh384('this is a message');>>test.sql
echo select 'select lsh384(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select lsh384('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_lsh384_exist

echo:
echo Testing lsh384blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select lsh384blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_lsh384_exist

:test_lsh512_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='lsh512';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_LSH512%"=="" goto after_test_lsh512_exist
echo Lsh512 Enabled - testing for lsh512 function
IF NOT "%ENABLED_LSH512%"=="" echo "LSH512 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="lsh512" set LSH512_EXISTS=1
IF "%LSH512_EXISTS%"=="1" echo lsh512 exists
IF NOT "%LSH512_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select lsh512('''');';>>test.sql
echo select lsh512('');>>test.sql
echo select 'select lsh512(''a'');';>>test.sql
echo select lsh512('a');>>test.sql
echo select 'select lsh512(''this is a message'');';>>test.sql
echo select lsh512('this is a message');>>test.sql
echo select 'select lsh512(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select lsh512('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_lsh512_exist

echo:
echo Testing lsh512blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select lsh512blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_lsh512_exist

:test_sm3_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='sm3';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_SM3%"=="" goto after_test_sm3_exist
echo Sm3 Enabled - testing for sm3 function
IF NOT "%ENABLED_SM3%"=="" echo "SM3 Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="sm3" set SM3_EXISTS=1
IF "%SM3_EXISTS%"=="1" echo sm3 exists
IF NOT "%SM3_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select sm3('''');';>>test.sql
echo select sm3('');>>test.sql
echo select 'select sm3(''a'');';>>test.sql
echo select sm3('a');>>test.sql
echo select 'select sm3(''this is a message'');';>>test.sql
echo select sm3('this is a message');>>test.sql
echo select 'select sm3(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select sm3('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_sm3_exist

echo:
echo Testing sm3blob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select sm3blob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log


goto after_test_sm3_exist

:test_whirlpool_exist

echo .load hashing>test.sql
echo select * FROM pragma_function_list where name='whirlpool';>>test.sql
echo .quit>>test.sql
IF "%ENABLED_WHIRLPOOL%"=="" goto after_test_whirlpool_exist
echo Whirlpool Enabled - testing for whirlpool function
IF NOT "%ENABLED_WHIRLPOOL%"=="" echo "WHIRLPOOL Set" && ..\sqlite\sqlite3.exe <test.sql>result.log
for /f "tokens=1 delims=|" %%A in (result.log) DO IF "%%A"=="whirlpool" set WHIRLPOOL_EXISTS=1
IF "%WHIRLPOOL_EXISTS%"=="1" echo whirlpool exists
IF NOT "%WHIRLPOOL_EXISTS%"=="1" goto test_fail

echo .load hashing>test.sql
echo select 'select whirlpool('''');';>>test.sql
echo select whirlpool('');>>test.sql
echo select 'select whirlpool(''a'');';>>test.sql
echo select whirlpool('a');>>test.sql
echo select 'select whirlpool(''this is a message'');';>>test.sql
echo select whirlpool('this is a message');>>test.sql
echo select 'select whirlpool(''1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890'');';>>test.sql
echo select whirlpool('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');>>test.sql
echo .quit>>test.sql
..\sqlite\sqlite3.exe <test.sql>result.log
type result.log

IF "%ENABLED_USE_BLOB%"==""  goto after_test_whirlpool_exist

echo:
echo Testing whirlpoolblob function
echo .load hashing>test.sql
echo create table test(test text,dateadded datetime);>>test.sql
echo insert into test(test,dateadded)VALUES('12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890','2024-06-12 00:00:00');>>test.sql
echo select whirlpoolblob('main','test','test',1);>>test.sql
echo .quit>>test.sql
type test.sql

..\sqlite\sqlite3.exe < test.sql>result.log
type result.log

goto after_test_whirlpool_exist


















